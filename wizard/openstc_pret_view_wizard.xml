<?xml version="1.0" ?>
<openerp>
	<data>
		<!-- wizard de gestion des emprunts à l'extèrieur -->
		<record model="ir.ui.view" id="view_openstc_pret_emprunt_wizard">
			<field name="name">openstc.pret.emprunt.wizard</field>
			<field name="model">openstc.pret.emprunt.wizard</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Emprunter des Ressources auprès de Collectivités extérieures">
					<field name="emprunt_line" nolabel="1" colspan="4" required="1" on_change="onchange_emprunt_line(emprunt_line, context)">
						<tree string="Lignes d'emprunt" editable="top">
							<field name="product_id" context="{'default_openstc_reservable':'1','default_purchase_ok':False}"/>
							<field name="partner_id" domain="[('supplier','=',True)]"/>
							<field name="qte"/>
							<field name="qty_needed"/>
							<field name="date_expected" />
						</tree>
					</field>
					<button icon="gtk-cancel" colspan="1" string="Cancel"
						special="cancel" />
					<button colspan="1" name="do_emprunt" string="Emprunter"
						type="object" />
				</form>
			</field>
		</record>

		<record model="ir.actions.act_window" id="action_view_openstc_pret_emprunt_wizard">
			<field name="name">Emprunter des Ressources à l'extérieur</field>
			<field name="res_model">openstc.pret.emprunt.wizard</field>
			<field name="view_type">form</field>
			<field name="view_mode">form</field>
			<field name="target">new</field>
		</record>

		<record model="ir.actions.act_window" id="action_view_openstc_pret_create_emprunt_wizard">
			<field name="name">Emprunter des Ressources à l'extérieur</field>
			<field name="res_model">openstc.pret.emprunt.wizard</field>
			<field name="view_type">form</field>
			<field name="view_mode">form</field>
			<field name="target">new</field>
			<field name="context">{'prod_error_ids':prod_error_ids,'reservation_id':reservation_id}</field>
		</record>

		<!-- Wizard "pop-up" pour déclencher ou non le wizard des emprunts à l'extèrieur -->

			<record model="ir.ui.view" id="view_openstc_pret_warning_dispo_wizard">
			<field name="name">openstc.pret.warning.dispo.wizard</field>
			<field name="model">openstc.pret.warning.dispo.wizard</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Des articles ne sont pas dispo">
					<label string="Attention, certains des articles que vous voulez réserver ne sont pas disponibles." colspan="4"/>
					<newline/>
					<label string="Une ou plusieurs dates ne sont disponibles pour les ressources sélectionnées.
					    Vous pouvez visualiser le planning pour adapter vos dates de réservation.
					    Vous avez aussi les droits pour déclencher une demande d'emprunt des articles manquants
		    			auprès de collectivités extérieurs, si vous voulez le faire ,cliquez sur 'Commencer l'Emprunt'." colspan="4"/>
					<newline />
					<button icon="gtk-cancel" colspan="1" string="Annuler"
						special="cancel"/>
					<button colspan="1" name="%(action_view_openstc_pret_create_emprunt_wizard)d" string="Commencer l'emprunt" type="action" />
					<button colspan="1" name="view_planning" string="Visualiser Planning" type="object"/>
				</form>
			</field>
		</record>

		<!-- Wizard de modification et confirmation d'envoi du mail d'annulation d'une réservation -->
		<record model="ir.actions.act_window" id="action_view_openstc_pret_create_envoi_mail_annulation_wizard">
			<field name="name">Envoi du mail d'annulation de la réservation</field>
			<field name="res_model">openstc.pret.envoie.mail.annulation.wizard</field>
			<field name="view_type">form</field>
			<field name="view_mode">form</field>
			<field name="target">new</field>
			<field name="context">{'active_id':active_id}</field>
		</record>

		<record model="ir.ui.view" id="view_openstc_pret_create_envoi_mail_annulation_wizard">
			<field name="name">openstc.pret.envoie.mail.annulation.wizard</field>
			<field name="model">openstc.pret.envoie.mail.annulation.wizard</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Envoi du mail d'annulation">
				    <field name="body_html" />
				    <newline />
					<button icon="gtk-go-back" colspan="1" string="Retour" special="cancel"/>
					<button icon="gtk-ok" colspan="1" name="do_cancel" type="object" string="Envoyer le mail"/>
					<button icon="gtk-go-forward" colspan="1" string="Ne pas envoyer le mail" type="object" name="do_cancel_without_mail"/>

				</form>
			</field>
		</record>

		<record model="ir.ui.view" id="view_openstc_pret_deliver_products_wizard">
			<field name="name">openstc.pret.deliver.products.wizard</field>
			<field name="model">openstc.pret.deliver.products.wizard</field>
			<field name="type">form</field>
			<field name="arch" type="xml">
				<form string="Comment mettre les articles à disposition">
				    <label colspan="4" string="Pour mettre les articles à dispositions, voulez-vous créer une intervention de livraison ou le demandeur vient les chercher sur place ?" />
				    <newline />
				    <field name="deliver_line" colspan="4" nolabel="1">
				    	<tree editable="top" string="Interventions pouvant être générées">
				    	    <field name="motif"/>
				    	    <field name="product_id" context="{'default_openstc_reservable':'1','default_purchase_ok':False}"/>
				    	    <field name="qte_reserves"/>
				    	    <field name="service_id"/>
				    	    <field name="site_details"/>
				    	    <field name="to_generate"/>
				    	</tree>
				    </field>
					<button icon="gtk-go-back" colspan="1" string="Retour" special="cancel"/>
					<button icon="gtk-ok" colspan="1" name="put_in_use_with_intervention" type="object" string="Générer une intervention"/>
					<button icon="gtk-go-forward" colspan="1" string="Ne pas générer d'intervention" type="object" name="put_in_use_without_intervention"/>
				</form>
			</field>
		</record>

		<!-- Wizard précédent l'état in_use d'une résa, permettant de choisir si l'on livre la résa ou si le demandeur passe la prendre -->
		<record model="ir.actions.act_window" id="action_view_openstc_pret_deliver_products_wizard">
			<field name="name">Mise a dispo des produits</field>
			<field name="res_model">openstc.pret.deliver.products.wizard</field>
			<field name="view_type">form</field>
			<field name="view_mode">form</field>
			<field name="target">new</field>
			<field name="context">{'active_id':active_id}</field>
		</record>

		<record model="ir.actions.act_window" id="action_view_openstc_pret_create_inter_wizard">
			<field name="name">Assistant de réservation pour générer une intervention</field>
			<field name="res_model">openstc.pret.create.inter.wizard</field>
			<field name="view_type">form</field>
			<field name="view_mode">form</field>
			<field name="target">new</field>
			<field name="context">{'active_id':active_id}</field>
		</record>
		
				
		<record model="ir.ui.view" id="openstc_pret_create_inter_wizard_form">
		    <field name="name">openstc.pret.create.inter.wizard.form</field>
		    <field name="model">openstc.pret.create.inter.wizard</field>
		    <field name="type">form</field>
		    <field name="arch" type="xml">
		        <form>
		            <group colspan="2" col="2">
		                <separator string="Générer l'intervention" colspan="2"/>
		            	<field name="service_id"/>
		            </group>
		            <group colspan="2" col="2">
		            	<separator string="Paramétrer la tâche" colspan="2"/>
		                <field name="time_planned"/>
			            <field name="categ_id"/>
		            </group>
		            <button special="cancel" string="Annuler" icon="gtk-cancel"/>
					<button name="validate" icon="gtk-go-forward" type="object" string="Valider"/>
		        </form>
		    </field>
		</record>

	</data>
</openerp>
